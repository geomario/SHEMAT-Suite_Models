import unittest
import numpy as np
import numpy.testing as npt
import h5py

try:
    import SHEMATtest_dirs as std
except ImportError:
    raise ImportError('No module named SHEMATtest_dirs. \n\n' + 'Solution: ' +
                      ' Add the path /path-to-SHEMAT-Suite_Models/' +
                      'SHEMAT-Suite_Models/deltatests/site-packages to the' +
                      ' PYTHONPATH.')


class Tests_sm_const_wavereal_enkf(unittest.TestCase):
    def test_conc0001_equal(self):

        for i in range(1, 11):
            fhdf1 = h5py.File(std.shemat_suite_models_dir +
                              '/sm_const_wavereal_enkf' + std.result_dir +
                              '/samples_output/WAVEREAL_E1_' + str(i) + '.h5')
            conc0001_array_desired = np.array(fhdf1['conc0001'])
            fhdf1.close()

            fhdf2 = h5py.File(
                std.shemat_suite_models_dir +
                '/sm_const_wavereal_enkf/samples_output/WAVEREAL_E1_' +
                str(i) + '.h5')
            conc0001_array_actual = np.array(fhdf2['conc0001'])
            fhdf2.close()

            npt.assert_allclose(
                conc0001_array_actual, conc0001_array_desired, rtol=1e-5)

    def test_comp_equal(self):

        for i in range(1, 11):
            fhdf1 = h5py.File(std.shemat_suite_models_dir +
                              '/sm_const_wavereal_enkf' + std.result_dir +
                              '/samples_output/WAVEREAL_E1_' + str(i) + '.h5')
            comp_array_desired = np.array(fhdf1['comp'])
            fhdf1.close()

            fhdf2 = h5py.File(
                std.shemat_suite_models_dir +
                '/sm_const_wavereal_enkf/samples_output/WAVEREAL_E1_' +
                str(i) + '.h5')
            comp_array_actual = np.array(fhdf2['comp'])
            fhdf2.close()

            npt.assert_allclose(
                comp_array_actual, comp_array_desired, rtol=1e-5)

    def test_uindex_equal(self):

        for i in range(1, 11):
            fhdf1 = h5py.File(std.shemat_suite_models_dir +
                              '/sm_const_wavereal_enkf' + std.result_dir +
                              '/samples_output/WAVEREAL_E1_' + str(i) + '.h5')
            uindex_array_desired = np.array(fhdf1['uindex'])
            fhdf1.close()

            fhdf2 = h5py.File(
                std.shemat_suite_models_dir +
                '/sm_const_wavereal_enkf/samples_output/WAVEREAL_E1_' +
                str(i) + '.h5')
            uindex_array_actual = np.array(fhdf2['uindex'])
            fhdf2.close()

            npt.assert_allclose(
                uindex_array_actual, uindex_array_desired, rtol=1e-5)

    def test_por_equal(self):

        for i in range(1, 11):
            fhdf1 = h5py.File(std.shemat_suite_models_dir +
                              '/sm_const_wavereal_enkf' + std.result_dir +
                              '/samples_output/WAVEREAL_E1_' + str(i) + '.h5')
            por_array_desired = np.array(fhdf1['por'])
            fhdf1.close()

            fhdf2 = h5py.File(
                std.shemat_suite_models_dir +
                '/sm_const_wavereal_enkf/samples_output/WAVEREAL_E1_' +
                str(i) + '.h5')
            por_array_actual = np.array(fhdf2['por'])
            fhdf2.close()

            npt.assert_allclose(por_array_actual, por_array_desired, rtol=1e-5)

    def test_temp_equal(self):

        for i in range(1, 11):
            fhdf1 = h5py.File(std.shemat_suite_models_dir +
                              '/sm_const_wavereal_enkf' + std.result_dir +
                              '/samples_output/WAVEREAL_E1_' + str(i) + '.h5')
            temp_array_desired = np.array(fhdf1['temp'])
            fhdf1.close()

            fhdf2 = h5py.File(
                std.shemat_suite_models_dir +
                '/sm_const_wavereal_enkf/samples_output/WAVEREAL_E1_' +
                str(i) + '.h5')
            temp_array_actual = np.array(fhdf2['temp'])
            fhdf2.close()

            npt.assert_allclose(
                temp_array_actual, temp_array_desired, rtol=1e-5)

    def test_lx_equal(self):

        for i in range(1, 11):
            fhdf1 = h5py.File(std.shemat_suite_models_dir +
                              '/sm_const_wavereal_enkf' + std.result_dir +
                              '/samples_output/WAVEREAL_E1_' + str(i) + '.h5')
            lx_array_desired = np.array(fhdf1['lx'])
            fhdf1.close()

            fhdf2 = h5py.File(
                std.shemat_suite_models_dir +
                '/sm_const_wavereal_enkf/samples_output/WAVEREAL_E1_' +
                str(i) + '.h5')
            lx_array_actual = np.array(fhdf2['lx'])
            fhdf2.close()

            npt.assert_allclose(lx_array_actual, lx_array_desired, rtol=1e-5)

    def test_ly_equal(self):

        for i in range(1, 11):
            fhdf1 = h5py.File(std.shemat_suite_models_dir +
                              '/sm_const_wavereal_enkf' + std.result_dir +
                              '/samples_output/WAVEREAL_E1_' + str(i) + '.h5')
            ly_array_desired = np.array(fhdf1['ly'])
            fhdf1.close()

            fhdf2 = h5py.File(
                std.shemat_suite_models_dir +
                '/sm_const_wavereal_enkf/samples_output/WAVEREAL_E1_' +
                str(i) + '.h5')
            ly_array_actual = np.array(fhdf2['ly'])
            fhdf2.close()

            npt.assert_allclose(ly_array_actual, ly_array_desired, rtol=1e-5)

    def test_lz_equal(self):

        for i in range(1, 11):
            fhdf1 = h5py.File(std.shemat_suite_models_dir +
                              '/sm_const_wavereal_enkf' + std.result_dir +
                              '/samples_output/WAVEREAL_E1_' + str(i) + '.h5')
            lz_array_desired = np.array(fhdf1['lz'])
            fhdf1.close()

            fhdf2 = h5py.File(
                std.shemat_suite_models_dir +
                '/sm_const_wavereal_enkf/samples_output/WAVEREAL_E1_' +
                str(i) + '.h5')
            lz_array_actual = np.array(fhdf2['lz'])
            fhdf2.close()

            npt.assert_allclose(lz_array_actual, lz_array_desired, rtol=1e-5)

    def test_head_equal(self):

        for i in range(1, 11):
            fhdf1 = h5py.File(std.shemat_suite_models_dir +
                              '/sm_const_wavereal_enkf' + std.result_dir +
                              '/samples_output/WAVEREAL_E1_' + str(i) + '.h5')
            head_array_desired = np.array(fhdf1['head'])
            fhdf1.close()

            fhdf2 = h5py.File(
                std.shemat_suite_models_dir +
                '/sm_const_wavereal_enkf/samples_output/WAVEREAL_E1_' +
                str(i) + '.h5')
            head_array_actual = np.array(fhdf2['head'])
            fhdf2.close()

            npt.assert_allclose(
                head_array_actual, head_array_desired, rtol=1e-5)

    def test_pres_equal(self):

        for i in range(1, 11):
            fhdf1 = h5py.File(std.shemat_suite_models_dir +
                              '/sm_const_wavereal_enkf' + std.result_dir +
                              '/samples_output/WAVEREAL_E1_' + str(i) + '.h5')
            pres_array_desired = np.array(fhdf1['pres'])
            fhdf1.close()

            fhdf2 = h5py.File(
                std.shemat_suite_models_dir +
                '/sm_const_wavereal_enkf/samples_output/WAVEREAL_E1_' +
                str(i) + '.h5')
            pres_array_actual = np.array(fhdf2['pres'])
            fhdf2.close()

            npt.assert_allclose(
                pres_array_actual, pres_array_desired, rtol=1e-5)

    def test_kx_equal(self):

        for i in range(1, 11):
            fhdf1 = h5py.File(std.shemat_suite_models_dir +
                              '/sm_const_wavereal_enkf' + std.result_dir +
                              '/samples_output/WAVEREAL_E1_' + str(i) + '.h5')
            kx_array_desired = np.array(fhdf1['kx'])
            fhdf1.close()

            fhdf2 = h5py.File(
                std.shemat_suite_models_dir +
                '/sm_const_wavereal_enkf/samples_output/WAVEREAL_E1_' +
                str(i) + '.h5')
            kx_array_actual = np.array(fhdf2['kx'])
            fhdf2.close()

            npt.assert_allclose(kx_array_actual, kx_array_desired, rtol=1e-5)

    def test_ky_equal(self):

        for i in range(1, 11):
            fhdf1 = h5py.File(std.shemat_suite_models_dir +
                              '/sm_const_wavereal_enkf' + std.result_dir +
                              '/samples_output/WAVEREAL_E1_' + str(i) + '.h5')
            ky_array_desired = np.array(fhdf1['ky'])
            fhdf1.close()

            fhdf2 = h5py.File(
                std.shemat_suite_models_dir +
                '/sm_const_wavereal_enkf/samples_output/WAVEREAL_E1_' +
                str(i) + '.h5')
            ky_array_actual = np.array(fhdf2['ky'])
            fhdf2.close()

            npt.assert_allclose(ky_array_actual, ky_array_desired, rtol=1e-5)

    def test_kz_equal(self):

        for i in range(1, 11):
            fhdf1 = h5py.File(std.shemat_suite_models_dir +
                              '/sm_const_wavereal_enkf' + std.result_dir +
                              '/samples_output/WAVEREAL_E1_' + str(i) + '.h5')
            kz_array_desired = np.array(fhdf1['kz'])
            fhdf1.close()

            fhdf2 = h5py.File(
                std.shemat_suite_models_dir +
                '/sm_const_wavereal_enkf/samples_output/WAVEREAL_E1_' +
                str(i) + '.h5')
            kz_array_actual = np.array(fhdf2['kz'])
            fhdf2.close()

            npt.assert_allclose(kz_array_actual, kz_array_desired, rtol=1e-5)

    def test_rhof_equal(self):

        for i in range(1, 11):
            fhdf1 = h5py.File(std.shemat_suite_models_dir +
                              '/sm_const_wavereal_enkf' + std.result_dir +
                              '/samples_output/WAVEREAL_E1_' + str(i) + '.h5')
            rhof_array_desired = np.array(fhdf1['rhof'])
            fhdf1.close()

            fhdf2 = h5py.File(
                std.shemat_suite_models_dir +
                '/sm_const_wavereal_enkf/samples_output/WAVEREAL_E1_' +
                str(i) + '.h5')
            rhof_array_actual = np.array(fhdf2['rhof'])
            fhdf2.close()

            npt.assert_allclose(
                rhof_array_actual, rhof_array_desired, rtol=1e-5)

    def test_visf_equal(self):

        for i in range(1, 11):
            fhdf1 = h5py.File(std.shemat_suite_models_dir +
                              '/sm_const_wavereal_enkf' + std.result_dir +
                              '/samples_output/WAVEREAL_E1_' + str(i) + '.h5')
            visf_array_desired = np.array(fhdf1['visf'])
            fhdf1.close()

            fhdf2 = h5py.File(
                std.shemat_suite_models_dir +
                '/sm_const_wavereal_enkf/samples_output/WAVEREAL_E1_' +
                str(i) + '.h5')
            visf_array_actual = np.array(fhdf2['visf'])
            fhdf2.close()

            npt.assert_allclose(
                visf_array_actual, visf_array_desired, rtol=1e-5)


def local_suite():
    local_suite = unittest.makeSuite(
        Tests_sm_const_wavereal_enkf, prefix='test')
    return local_suite


def local_run():
    runner = unittest.TextTestRunner(verbosity=2)
    runner.run(local_suite())


if __name__ == "__main__":
    local_run()
