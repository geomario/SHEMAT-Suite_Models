import unittest
import numpy.testing as npt
import h5py

try:
    import SHEMATtest_dirs as std
except ImportError:
    raise ImportError('No module named SHEMATtest_dirs. \n\n' + 'Solution: ' +
                      ' Add the path /path-to-SHEMAT-Suite_Models/' +
                      'SHEMAT-Suite_Models/deltatests/site-packages to the' +
                      ' PYTHONPATH.')


class Tests_fw_kola_HeatConduction2D(unittest.TestCase):
    def test_comp_equal(self):

        comp_array_desired = h5py.File(
            std.shemat_suite_models_dir +
            '/fw_kola_HeatConduction2D/result/fw_kola_2D-Heat-Conduction_final.h5'
        )['comp']
        comp_array_actual = h5py.File(
            std.shemat_suite_models_dir +
            '/fw_kola_HeatConduction2D/fw_kola_2D-Heat-Conduction_final.h5'
        )['comp']

        npt.assert_allclose(comp_array_actual, comp_array_desired, rtol=1e-5)

    def test_uindex_equal(self):

        uindex_array_desired = h5py.File(
            std.shemat_suite_models_dir +
            '/fw_kola_HeatConduction2D/result/fw_kola_2D-Heat-Conduction_final.h5'
        )['uindex']
        uindex_array_actual = h5py.File(
            std.shemat_suite_models_dir +
            '/fw_kola_HeatConduction2D/fw_kola_2D-Heat-Conduction_final.h5'
        )['uindex']

        npt.assert_allclose(
            uindex_array_actual, uindex_array_desired, rtol=1e-5)

    def test_por_equal(self):

        por_array_desired = h5py.File(
            std.shemat_suite_models_dir +
            '/fw_kola_HeatConduction2D/result/fw_kola_2D-Heat-Conduction_final.h5'
        )['por']
        por_array_actual = h5py.File(
            std.shemat_suite_models_dir +
            '/fw_kola_HeatConduction2D/fw_kola_2D-Heat-Conduction_final.h5'
        )['por']

        npt.assert_allclose(por_array_actual, por_array_desired, rtol=1e-5)

    def test_temp_equal(self):

        temp_array_desired = h5py.File(
            std.shemat_suite_models_dir +
            '/fw_kola_HeatConduction2D/result/fw_kola_2D-Heat-Conduction_final.h5'
        )['temp']
        temp_array_actual = h5py.File(
            std.shemat_suite_models_dir +
            '/fw_kola_HeatConduction2D/fw_kola_2D-Heat-Conduction_final.h5'
        )['temp']

        npt.assert_allclose(temp_array_actual, temp_array_desired, rtol=1e-5)

    def test_lx_equal(self):

        lx_array_desired = h5py.File(
            std.shemat_suite_models_dir +
            '/fw_kola_HeatConduction2D/result/fw_kola_2D-Heat-Conduction_final.h5'
        )['lx']
        lx_array_actual = h5py.File(
            std.shemat_suite_models_dir +
            '/fw_kola_HeatConduction2D/fw_kola_2D-Heat-Conduction_final.h5'
        )['lx']

        npt.assert_allclose(lx_array_actual, lx_array_desired, rtol=1e-5)

    def test_ly_equal(self):

        ly_array_desired = h5py.File(
            std.shemat_suite_models_dir +
            '/fw_kola_HeatConduction2D/result/fw_kola_2D-Heat-Conduction_final.h5'
        )['ly']
        ly_array_actual = h5py.File(
            std.shemat_suite_models_dir +
            '/fw_kola_HeatConduction2D/fw_kola_2D-Heat-Conduction_final.h5'
        )['ly']

        npt.assert_allclose(ly_array_actual, ly_array_desired, rtol=1e-5)

    def test_lz_equal(self):

        lz_array_desired = h5py.File(
            std.shemat_suite_models_dir +
            '/fw_kola_HeatConduction2D/result/fw_kola_2D-Heat-Conduction_final.h5'
        )['lz']
        lz_array_actual = h5py.File(
            std.shemat_suite_models_dir +
            '/fw_kola_HeatConduction2D/fw_kola_2D-Heat-Conduction_final.h5'
        )['lz']

        npt.assert_allclose(lz_array_actual, lz_array_desired, rtol=1e-5)

    def test_head_equal(self):

        head_array_desired = h5py.File(
            std.shemat_suite_models_dir +
            '/fw_kola_HeatConduction2D/result/fw_kola_2D-Heat-Conduction_final.h5'
        )['head']
        head_array_actual = h5py.File(
            std.shemat_suite_models_dir +
            '/fw_kola_HeatConduction2D/fw_kola_2D-Heat-Conduction_final.h5'
        )['head']

        npt.assert_allclose(head_array_actual, head_array_desired, rtol=1e-5)

    def test_pres_equal(self):

        pres_array_desired = h5py.File(
            std.shemat_suite_models_dir +
            '/fw_kola_HeatConduction2D/result/fw_kola_2D-Heat-Conduction_final.h5'
        )['pres']
        pres_array_actual = h5py.File(
            std.shemat_suite_models_dir +
            '/fw_kola_HeatConduction2D/fw_kola_2D-Heat-Conduction_final.h5'
        )['pres']

        npt.assert_allclose(pres_array_actual, pres_array_desired, rtol=1e-5)

    def test_kx_equal(self):

        kx_array_desired = h5py.File(
            std.shemat_suite_models_dir +
            '/fw_kola_HeatConduction2D/result/fw_kola_2D-Heat-Conduction_final.h5'
        )['kx']
        kx_array_actual = h5py.File(
            std.shemat_suite_models_dir +
            '/fw_kola_HeatConduction2D/fw_kola_2D-Heat-Conduction_final.h5'
        )['kx']

        npt.assert_allclose(kx_array_actual, kx_array_desired, rtol=1e-5)

    def test_ky_equal(self):

        ky_array_desired = h5py.File(
            std.shemat_suite_models_dir +
            '/fw_kola_HeatConduction2D/result/fw_kola_2D-Heat-Conduction_final.h5'
        )['ky']
        ky_array_actual = h5py.File(
            std.shemat_suite_models_dir +
            '/fw_kola_HeatConduction2D/fw_kola_2D-Heat-Conduction_final.h5'
        )['ky']

        npt.assert_allclose(ky_array_actual, ky_array_desired, rtol=1e-5)

    def test_kz_equal(self):

        kz_array_desired = h5py.File(
            std.shemat_suite_models_dir +
            '/fw_kola_HeatConduction2D/result/fw_kola_2D-Heat-Conduction_final.h5'
        )['kz']
        kz_array_actual = h5py.File(
            std.shemat_suite_models_dir +
            '/fw_kola_HeatConduction2D/fw_kola_2D-Heat-Conduction_final.h5'
        )['kz']

        npt.assert_allclose(kz_array_actual, kz_array_desired, rtol=1e-5)

    def test_rhof_equal(self):

        rhof_array_desired = h5py.File(
            std.shemat_suite_models_dir +
            '/fw_kola_HeatConduction2D/result/fw_kola_2D-Heat-Conduction_final.h5'
        )['rhof']
        rhof_array_actual = h5py.File(
            std.shemat_suite_models_dir +
            '/fw_kola_HeatConduction2D/fw_kola_2D-Heat-Conduction_final.h5'
        )['rhof']

        npt.assert_allclose(rhof_array_actual, rhof_array_desired, rtol=1e-5)

    def test_visf_equal(self):

        visf_array_desired = h5py.File(
            std.shemat_suite_models_dir +
            '/fw_kola_HeatConduction2D/result/fw_kola_2D-Heat-Conduction_final.h5'
        )['visf']
        visf_array_actual = h5py.File(
            std.shemat_suite_models_dir +
            '/fw_kola_HeatConduction2D/fw_kola_2D-Heat-Conduction_final.h5'
        )['visf']

        npt.assert_allclose(visf_array_actual, visf_array_desired, rtol=1e-5)


def local_suite():
    local_suite = unittest.makeSuite(
        Tests_fw_kola_HeatConduction2D, prefix='test')
    return local_suite


def local_run():
    runner = unittest.TextTestRunner(verbosity=2)
    runner.run(local_suite())


if __name__ == "__main__":
    local_run()
